# ะัะฟะพะปัะทะพะฒะฐะฝะธะต Vite ะฒ ะฟัะพะตะบัะต

## TL;DR

**Vite ะธัะฟะพะปัะทัะตััั ะขะะะฌะะ ะดะปั ัะฑะพัะบะธ, ะะ ะฒ runtime.**

```
ะกะฑะพัะบะฐ:    Vite โ (npm run build)
Runtime:   Nginx โ (ะพัะดะฐะตั ััะฐัะธะบั ะธะท dist/)
Dev server: Vite โ (ะฝะต ะทะฐะฟััะตะฝ, ะฝะพ ะผะพะถะฝะพ ะทะฐะฟัััะธัั)
```

## ะขะตะบััะฐั ะฐััะธัะตะบัััะฐ (Production)

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ   ะัะฐัะทะตั   โโโโโถโ    Nginx     โโโโโถโ   dist/     โ
โ             โ    โ              โ    โ  (ััะฐัะธะบะฐ)  โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
                                             โฒ
                                             โ
                                    ะกะพะทะดะฐะฝะพ ัะตัะตะท:
                                    npm run build
                                    (vite build)
```

**ะงัะพ ะฟัะพะธััะพะดะธั:**

1. **ะกะฑะพัะบะฐ** (ะพะดะธะฝ ัะฐะท ะธะปะธ ะฟัะธ ะธะทะผะตะฝะตะฝะธัั):
   ```bash
   ./build-frontend-docker.sh
   ```
   - ะะฐะฟััะบะฐะตั Docker ะบะพะฝัะตะนะฝะตั ั Node.js
   - ะะฝัััะธ ะบะพะฝัะตะนะฝะตัะฐ: `npm run build`
   - `npm run build` = `tsc -b && vite build`
   - Vite ัะพะฑะธัะฐะตั ะพะฟัะธะผะธะทะธัะพะฒะฐะฝะฝัะน bundle โ `dist/`
   - ะะพะฟะธััะตั `dist/` ะฝะฐ ัะพัั
   - ะะตัะตะทะฐะฟััะบะฐะตั nginx

2. **Runtime** (ะฟะพััะพัะฝะฝะพ):
   ```
   http://cityquest.test/
     โ
   Nginx
     โ
   /app/frontend/dist/index.html
   ```
   - Vite ะะ ััะฐััะฒัะตั
   - ะขะพะปัะบะพ ััะฐัะธัะตัะบะธะต ัะฐะนะปั
   - ะะตั HMR (Hot Module Replacement)

## ะะปััะตัะฝะฐัะธะฒะฝัะน ัะตะถะธะผ (Development)

ะัะปะธ ะฝัะถะตะฝ ะฑัััััะน ัะธะบะป ัะฐะทัะฐะฑะพัะบะธ ั HMR:

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ   ะัะฐัะทะตั   โโโโโถโ Vite Dev     โโโโโถโ   src/      โ
โ             โ    โ Server :5173 โ    โ  (ะธััะพะดะฝะธะบะธ)โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
                          โ
                          โผ
                   Proxy โ Symfony API
                   (http://cityquest.test/api)
```

**ะะฐะฟััะบ:**

```bash
# ะขัะตะฑัะตั Node.js ะฝะฐ ัะพััะต
cd /Users/aleas/proj/cityQuest/frontend/web
npm install  # ะตัะปะธ ะตัะต ะฝะต ัััะฐะฝะพะฒะปะตะฝะพ
npm run dev
```

**ะัะบัััั:** http://localhost:5173

**ะัะตะธะผััะตััะฒะฐ:**
- โ ะะณะฝะพะฒะตะฝะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ะฟัะธ ะธะทะผะตะฝะตะฝะธะธ ะบะพะดะฐ (HMR)
- โ ะะต ะฝัะถะฝะพ ะฟะตัะตัะพะฑะธัะฐัั ะฟะพัะปะต ะบะฐะถะดะพะณะพ ะธะทะผะตะฝะตะฝะธั
- โ Proxy ะฝะฐ Symfony API ัะฐะฑะพัะฐะตั ะฐะฒัะพะผะฐัะธัะตัะบะธ

**ะะตะดะพััะฐัะบะธ:**
- โ๏ธ ะขัะตะฑัะตั Node.js ะฝะฐ ัะพััะต
- โ๏ธ ะัะดะตะปัะฝัะน URL (localhost:5173 ะฒะผะตััะพ cityquest.test)
- โ๏ธ ะะต production build

## ะกัะฐะฒะฝะตะฝะธะต ัะตะถะธะผะพะฒ

| ะัะธัะตัะธะน | Production (nginx) | Development (Vite) |
|----------|-------------------|-------------------|
| **ะะฐะฟััะบ** | `./build-frontend-docker.sh` | `npm run dev` |
| **URL** | http://cityquest.test | http://localhost:5173 |
| **HMR** | โ ะะตั | โ ะะฐ |
| **ะกะบะพัะพััั ัะฐะทัะฐะฑะพัะบะธ** | ๐ ะะตะดะปะตะฝะฝะพ | โก ะััััะพ |
| **Production ready** | โ ะะฐ | โ ะะตั |
| **ะขัะตะฑัะตั Node.js** | โ ะะตั (Docker) | โ ะะฐ |
| **ะะพัะปะต ะธะทะผะตะฝะตะฝะธะน** | ะะตัะตัะฑะพัะบะฐ | ะะฒัะพะพะฑะฝะพะฒะปะตะฝะธะต |

## ะคะฐะนะปั ะบะพะฝัะธะณััะฐัะธะธ

### `vite.config.ts`

```typescript
export default defineConfig({
  plugins: [react()],
  
  // Build ะฝะฐัััะพะนะบะธ (ะดะปั production)
  build: {
    outDir: 'dist',
    // ...
  },
  
  // Dev server ะฝะฐัััะพะนะบะธ (ะดะปั npm run dev)
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://cityquest.test',
        // ...
      }
    }
  },
});
```

**ะัะฟะพะปัะทัะตััั ะฒ:**
- `npm run build` โ ัะตะบัะธั `build`
- `npm run dev` โ ัะตะบัะธั `server`

### `package.json`

```json
{
  "scripts": {
    "dev": "vite",              // โ Vite dev server
    "build": "tsc -b && vite build"  // โ Production ัะฑะพัะบะฐ
  }
}
```

## Workflow

### ะะฑััะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ (ะฑะตะท HMR)

```bash
# 1. ะะทะผะตะฝัะตะผ ะบะพะด ะฒ src/
vim frontend/web/src/react-app/pages/Home.tsx

# 2. ะะตัะตัะพะฑะธัะฐะตะผ
./build-frontend-docker.sh

# 3. ะัะพะฒะตััะตะผ
open http://cityquest.test
```

### ะััััะฐั ัะฐะทัะฐะฑะพัะบะฐ (ั HMR)

```bash
# 1. ะะฐะฟัััะธัั dev server (ะพะดะธะฝ ัะฐะท)
cd frontend/web
npm run dev

# 2. ะะทะผะตะฝัะตะผ ะบะพะด ะฒ src/
vim src/react-app/pages/Home.tsx

# 3. ะะฒัะพะผะฐัะธัะตัะบะธ ะพะฑะฝะพะฒะปัะตััั ะฒ ะฑัะฐัะทะตัะต!
# http://localhost:5173 - ัะถะต ะพะฑะฝะพะฒะปะตะฝ
```

### ะคะธะฝะฐะปัะฝะฐั ะฟัะพะฒะตัะบะฐ

```bash
# ะะตัะตะด ะบะพะผะผะธัะพะผ ะฟัะพะฒะตัะธัั production build
./build-frontend-docker.sh
open http://cityquest.test
```

## FAQ

### Q: Vite ะทะฐะผะตะดะปัะตั ะฟัะพะตะบั?
**A:** ะะตั. Vite ะธัะฟะพะปัะทัะตััั ัะพะปัะบะพ ะดะปั ัะฑะพัะบะธ, ะฝะต ะฒ runtime.

### Q: ะะพะถะฝะพ ะปะธ ัะฑัะฐัั Vite?
**A:** ะะพะถะฝะพ ะทะฐะผะตะฝะธัั ะฝะฐ ะดััะณะพะน ัะฑะพััะธะบ (Webpack, esbuild), ะฝะพ Vite - ััะพ ััะฐะฝะดะฐัั ะดะปั React ะฟัะพะตะบัะพะฒ.

### Q: ะัะถะฝะพ ะปะธ ััะฐะฒะธัั Node.js?
**A:** ะะตั! ะกะฑะพัะบะฐ ะธะดะตั ัะตัะตะท Docker. Node.js ะฝัะถะตะฝ ัะพะปัะบะพ ะดะปั dev ัะตะถะธะผะฐ ั HMR.

### Q: ะะพัะตะผั ะฝะต ะธัะฟะพะปัะทัะตััั Vite dev server ะฒ production?
**A:** 
1. Vite dev server ะฝะต ะฟัะตะดะฝะฐะทะฝะฐัะตะฝ ะดะปั production
2. Nginx ะฑััััะตะต ะพัะดะฐะตั ััะฐัะธะบั
3. ะัะพัะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต
4. ะกัะฐะฝะดะฐััะฝัะน production ะฟะพะดัะพะด

### Q: ะะฐะบ ะฟะตัะตะนัะธ ะฝะฐ dev ัะตะถะธะผ ั HMR?
**A:** 
```bash
brew install node  # macOS
cd frontend/web
npm install
npm run dev
```

## ะัะพะณะพ

**ะขะตะบััะธะน ัะตะถะธะผ:**
- โ Vite ัะพะฑะธัะฐะตั bundle
- โ Nginx ะพัะดะฐะตั ััะฐัะธะบั
- โ Production-ready
- โ ะะต ััะตะฑัะตั Node.js ะฝะฐ ัะพััะต

**ะะฟัะธะพะฝะฐะปัะฝัะน dev ัะตะถะธะผ:**
- โ Vite dev server ั HMR
- โ ะััััะฐั ัะฐะทัะฐะฑะพัะบะฐ
- โ๏ธ ะขัะตะฑัะตั Node.js
- โ๏ธ ะขะพะปัะบะพ ะดะปั ัะฐะทัะฐะฑะพัะบะธ
